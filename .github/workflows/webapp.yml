---
name: Create Lambda Function using Terraform
on:
  push:
    branches:
      - main
jobs:
  terraform:
    name: Running Terraform.
    runs-on: ubuntu-latest
    environment: Development
    # Use the Bash shell regardless whether
    # the GitHub Actions runner is ubuntu-latest.
    defaults:
      run:
        shell: bash
    steps:
      # Checkout the repository to the GitHub Actions runner.
      - name: Git Checkout.
        uses: actions/checkout@v2

      # Official Github Action to run Liquibase in your pipeline.
      #- name: Liquibase Pipeline.
        #uses: liquibase/liquibase-github-action@v3
        #with:
          #operation: 'update'
          #classpath: './postgresql/webappdb/public'
          #changeLogFile: '2022.01.31.ChangeLog.sql'
          #username: ${{ secrets.DB_USERNAME }}
          #password: ${{ secrets.DB_PASSWORD }}
          #url: ${{ secrets.DB_URL }}

      # Preparing and pushing documetation into README.md
      #- name: Prepare Terraform Doc and Push to README.md
        #uses: terraform-docs/gh-actions@main
        #with:
          #working-dir: .
          #output-file: README.md
          #output-method: inject
          #git-push: "true"

      # Install the latest version of Terraform CLI,
      # and configure the Terraform CLI configuration file
      # with a Terraform Cloud user API token.
      - name: Setup Terraform.
        uses: hashicorp/setup-terraform@v1
        with:
          cli_config_credentials_token: ${{ secrets.TF_API_TOKEN }}

      # Destroy Terraform state.
      - name: Destroy Terraform State.
        run: terraform destroy
